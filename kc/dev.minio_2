#
# Generated by omcli
# Cluster:dev.x2-4 Node:dev.x2-4.minio-1
#
cat << 'OMHOST' > omhost
# Generated by omcli #omdb.omnode

192.168.10.21  dev.x2-4.kafka-1.ctrl-0       #omdb.omnode
192.168.104.2  dev.x2-4.kafka-1.ext-0        #omdb.omnode
192.168.214.2  dev.x2-4.kafka-1.ib-0         #omdb.omnode
192.168.204.2  dev.x2-4.kafka-1.int-0        #omdb.omnode
192.168.10.31  dev.x2-4.kafka-2.ctrl-0       #omdb.omnode
192.168.104.3  dev.x2-4.kafka-2.ext-0        #omdb.omnode
192.168.214.3  dev.x2-4.kafka-2.ib-0         #omdb.omnode
192.168.204.3  dev.x2-4.kafka-2.int-0        #omdb.omnode
192.168.10.41  dev.x2-4.kafka-3.ctrl-0       #omdb.omnode
192.168.104.4  dev.x2-4.kafka-3.ext-0        #omdb.omnode
192.168.214.4  dev.x2-4.kafka-3.ib-0         #omdb.omnode
192.168.204.4  dev.x2-4.kafka-3.int-0        #omdb.omnode
192.168.10.51  dev.x2-4.kafka-4.ctrl-0       #omdb.omnode
192.168.104.5  dev.x2-4.kafka-4.ext-0        #omdb.omnode
192.168.214.5  dev.x2-4.kafka-4.ib-0         #omdb.omnode
192.168.204.5  dev.x2-4.kafka-4.int-0        #omdb.omnode
192.168.10.11  dev.x2-4.kafkacw-1.ctrl-0     #omdb.omnode
192.168.104.1  dev.x2-4.kafkacw-1.ext-0      #omdb.omnode
192.168.10.11  dev.x2-4.kafkaui-1.ctrl-0     #omdb.omnode
192.168.104.1  dev.x2-4.kafkaui-1.ext-0      #omdb.omnode
192.168.10.61  dev.x2-4.kafkaw-1.ctrl-0      #omdb.omnode
192.168.104.6  dev.x2-4.kafkaw-1.ext-0       #omdb.omnode
192.168.10.71  dev.x2-4.kafkaw-2.ctrl-0      #omdb.omnode
192.168.104.7  dev.x2-4.kafkaw-2.ext-0       #omdb.omnode
192.168.10.11  dev.x2-4.minio-1.ctrl-0       #omdb.omnode
192.168.104.1  dev.x2-4.minio-1.ext-0        #omdb.omnode
192.168.10.21  dev.x2-4.rdp-1.ctrl-0         #omdb.omnode
192.168.104.2  dev.x2-4.rdp-1.ext-0          #omdb.omnode
192.168.214.2  dev.x2-4.rdp-1.ib-0           #omdb.omnode
192.168.204.2  dev.x2-4.rdp-1.int-0          #omdb.omnode
192.168.10.31  dev.x2-4.rdp-2.ctrl-0         #omdb.omnode
192.168.104.3  dev.x2-4.rdp-2.ext-0          #omdb.omnode
192.168.214.3  dev.x2-4.rdp-2.ib-0           #omdb.omnode
192.168.204.3  dev.x2-4.rdp-2.int-0          #omdb.omnode
192.168.10.41  dev.x2-4.rdp-3.ctrl-0         #omdb.omnode
192.168.104.4  dev.x2-4.rdp-3.ext-0          #omdb.omnode
192.168.214.4  dev.x2-4.rdp-3.ib-0           #omdb.omnode
192.168.204.4  dev.x2-4.rdp-3.int-0          #omdb.omnode
192.168.10.51  dev.x2-4.rdp-4.ctrl-0         #omdb.omnode
192.168.104.5  dev.x2-4.rdp-4.ext-0          #omdb.omnode
192.168.214.5  dev.x2-4.rdp-4.ib-0           #omdb.omnode
192.168.204.5  dev.x2-4.rdp-4.int-0          #omdb.omnode
192.168.10.11  dev.x2-4.rdpui-1.ctrl-0       #omdb.omnode
192.168.104.1  dev.x2-4.rdpui-1.ext-0        #omdb.omnode
192.168.10.21  dev.x2-4.tap-1_ext_0.ctrl-0   #omdb.omnode
192.168.104.2  dev.x2-4.tap-1_ext_0.ext-0    #omdb.omnode
192.168.214.2  dev.x2-4.tap-1_ext_0.ib-0     #omdb.omnode
192.168.204.2  dev.x2-4.tap-1_ext_0.int-0    #omdb.omnode
192.168.10.51  dev.x2-4.tap-4_ext_0.ctrl-0   #omdb.omnode
192.168.104.5  dev.x2-4.tap-4_ext_0.ext-0    #omdb.omnode
192.168.214.5  dev.x2-4.tap-4_ext_0.ib-0     #omdb.omnode
192.168.204.5  dev.x2-4.tap-4_ext_0.int-0    #omdb.omnode
192.168.10.51  dev.x2-4.x2-0.ctrl-0          #omdb.omnode
192.168.104.5  dev.x2-4.x2-0.ext-0           #omdb.omnode
192.168.214.5  dev.x2-4.x2-0.ib-0            #omdb.omnode
192.168.204.5  dev.x2-4.x2-0.int-0           #omdb.omnode
192.168.10.31  dev.x2-4.x2-1.ctrl-0          #omdb.omnode
192.168.104.3  dev.x2-4.x2-1.ext-0           #omdb.omnode
192.168.214.3  dev.x2-4.x2-1.ib-0            #omdb.omnode
192.168.204.3  dev.x2-4.x2-1.int-0           #omdb.omnode
192.168.10.41  dev.x2-4.x2-2.ctrl-0          #omdb.omnode
192.168.104.4  dev.x2-4.x2-2.ext-0           #omdb.omnode
192.168.214.4  dev.x2-4.x2-2.ib-0            #omdb.omnode
192.168.204.4  dev.x2-4.x2-2.int-0           #omdb.omnode
192.168.10.21  dev.x2-4.x2-3.ctrl-0          #omdb.omnode
192.168.104.2  dev.x2-4.x2-3.ext-0           #omdb.omnode
192.168.214.2  dev.x2-4.x2-3.ib-0            #omdb.omnode
192.168.204.2  dev.x2-4.x2-3.int-0           #omdb.omnode
192.168.10.11  dev.x2-4.x2w-1.ctrl-0         #omdb.omnode
192.168.104.1  dev.x2-4.x2w-1.ext-0          #omdb.omnode
# Generated by omcli #omdb.omnode

192.168.10.11  shared.ca-1.easyca-1.ctrl-0   #omdb.omnode
192.168.101.1  shared.ca-1.easyca-1.ext-0    #omdb.omnode
OMHOST
cat /etc/hosts | grep -v "#omdb.omnode" >host
cat omhost >> host
cat host | sudo tee /etc/hosts &> /dev/null
rm -f omhost host
function init_mc {
mc alias set minio-02 http://dev.x2-4.minio-1.ext-0:1673 minioadmin minioadmin --api S3v4 --path auto
}
function start_minio {
nohup minio server --address dev.x2-4.minio-1.ext-0:1673 --console-address dev.x2-4.minio-1.ctrl-0:1674 /minio_dir 1>minio.log 2>&1 &
}
#
function stop_minio {
kill -9 $(pidof minio) 1>/dev/null 2>/dev/null || { echo "====Was not running"; }
}
function status_minio {
 lsof -P -i :1673 || { echo "====Not running"; }
for bucket in $(mc ls minio-02/ | grep dev.x2-4 | awk '{print $5}'); do
    echo "Contents of bucket: $bucket"
    mc ls --recursive minio-02/$bucket
done
}
function init_mc {
mc alias set minio-02 http://dev.x2-4.minio-1.ext-0:1673 minioadmin minioadmin --api S3v4 --path auto
}
init_mc
echo "script:info  node:dev.minio-02 omnode:dev.x2-4.minio-1 option:$1 "
case $1 in
     start)
     stop_minio
     start_minio
     ;;
     start_clean)
     stop_minio
     format_minio
     start_minio
     ;;
     stop)
     stop_minio
     ;;
     status)
     status_minio
     ;;
     *)
     ;;
esac
